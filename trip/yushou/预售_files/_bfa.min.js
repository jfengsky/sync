/**
 * Ctrip JavaScript Code
 * http://www.ctrip.com/
 * Copyright(C) 2008 - 2014, Ctrip All rights reserved.
 * Version: 140418
 * Date: 2014-04-18
 */
;window.replace=function(){return ''};(function(g,F){try{if(!g.$_bf||!0!==g.$_bf.loaded){g.$_bf=g.$_bf||{};g.$_bf.version="2.0.12";g.$_bf.loaded=!0;var k=g.document,u=k.location,c=c||{},G=Object.prototype.toString,w=function(){},B={undefined:"undefined",number:"number","boolean":"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error","[object Object]":"object"};c.PROTOCOL=(-1!=u.protocol.indexOf("file:")?"http:":u.protocol);c.ENV=g.$_bf.env||
"online";c.ishttps=("https:"==c.PROTOCOL?!0:!1);c.CFG={domain:u.hostname.split(".").slice(-2).join(".")||".ctrip.com",referrer:!1,cv1:!1,orderID:"",cookiePath:"/",surl:c.PROTOCOL+"//s.c-ctrip.com/",href:u.href,dCollect:{},delay:0,debug:!1};c.now=Date.now||function(){return(new Date).getTime()};c.type=function(a){return B[typeof a]||B[G.call(a)]||((a?"object":"null"))};c.isArray=function(a){return"array"===c.type(a)};c.isFunction=function(a){return"function"===c.type(a)};c.isNumber=function(a){return"number"===
typeof a&&isFinite(a)};c.isEmpty=function(a){return a===F||"-"==a||""==a};c.getRand=function(){return Math.round(2147483647*Math.random())};c.hash=function(a){var b=1,d=0,e;if(!c.isEmpty(a))for(b=0,e=a.length-1;0<=e;e--)d=a.charCodeAt(e),b=(b<<6&268435455)+d+(d<<14),d=b&266338304,b=(0!=d?b^d>>21:b);return b};c.$=function(a){return k.getElementById(a)};c.$v=function(a){return(a=c.$(a))&&a.value||""};c.encode=function(a){return encodeURIComponent(a)};c.decode=function(a){return decodeURIComponent(a)};
c.contains=function(a,b){return-1<a.indexOf(b)};c.getCookie=function(a,b,d){return((a=k.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)")))?(d?c.decode(a[2]):a[2]):b||"")};c.getCookieObj=function(a,b){var d={__k:a},e=[],f;if(e=c.getCookie(a,"",b))for(var e=e.split("&")||[],p=0;p<e.length;p++)f=e[p].split("="),1<f.length&&(d[f[0]]=f[1]);return d};c.setCookie=function(a,b,d){var e=(c.CFG.domain?";domain="+c.CFG.domain:""),f="";0<=d&&(f=";expires="+(new Date(c.now()+d)).toUTCString());k.cookie=a+"="+c.encode(b)+
e+";path=/"+f};c.get=function(a,b){var d,e={};b=b||{};e.v=b.v||"";e.w=b.w||"default";e.l=b.l||0;e.t=b.t||"string";switch(e.w){case "input":d=c.$v(a);break;case "cookie":d=c.getCookie(a,e.v);break;case "function":d=(c.isFunction(e.v)?e.v():"");break;case "object":break;default:d=e.v}switch(e.t){case "number":return parseInt(e.v,10)||0;case "boolean":return!!d;default:return (e.l?String(d).substring(0,e.l):d)}};c.getXpath=function(a){for(var b=[],d=0;a;){var c=b,f=d++,p=a.nodeName,g;a:{g=0;if(a.parentNode)for(var l=
a.parentNode.firstChild;l;){if(l==a){g=(0==g?"":"["+(g+1)+"]");break a}1==l.nodeType&&l.tagName==a.tagName&&g++;l=l.nextSibling}g=""}c[f]=p+g;if("HTML"!=a.tagName.toUpperCase())a=a.parentNode;else break}b=b.reverse();return b.join("/")};c.CLI=function(){var a=g.screen,b=g.navigator,d=(a?a.colorDepth+"-bit":""),e=((b&&b.language?b.language:(b&&b.browserLanguage?b.browserLanguage:""))).toLowerCase(),f=(b&&b.javaEnabled()?1:0);return{s:a,c:d,l:e,j:f,getRefer:function(){if(c.CFG.referrer)return c.CFG.referrer;
var a="";try{a=k&&k.referrer}catch(b){}if(!a)try{g.opener&&(a=g.opener.location&&g.opener.location.href)}catch(d){}c.CFG.referrer=String(a).substring(0,500);return c.CFG.referrer},getHash:function(){for(var p=g.history.length,h=[b.appName,b.appVersion,e,b.platform,b.userAgent,f,a.width+a.height,d,(k.cookie?k.cookie:""),(k.referrer?k.referrer:"")].join(""),l=h.length;0<p;)h+=p--^l++;return c.hash(h)}}}();c.send=function(a,b){var d=(c.CFG.debug?"http://localhost/bf.gif":c.CFG.surl+"bf.gif"),d=d+("?"+a+"&rd="+
c.getRand()+"&mt="+c.now()+"&jv=2.0.12");c.isFunction(b)||(b=w);var e=(new Image);e.width=1;e.height=1;e.onload=function(){e.onload=null;b(1)};e.onerror=function(){e.onerror=null;b(0)};e.src=d};c.on=function(){return (k.addEventListener?function(a,b,d,c){a.addEventListener(b,d,c||!1)}:(k.attachEvent?function(a,b,d){a.attachEvent("on"+b,d)}:w))}();c.isSupportStorage=function(){var a=!1;if("undefined"!=typeof Storage)try{g.localStorage.setItem("_tmptest","tmpval"),a=!0,g.localStorage.removeItem("_tmptest")}catch(b){}return (a?
!0:!1)}();c.isSupportCookie=function(){var a=!1;try{var b="_bfp"+c.getRand();c.setCookie("_bfp",b);c.getCookie("_bfp")===b&&(a=!0)}catch(d){}return a}();c.isReady=!1;c.ready=function(){function a(){if(!c.isReady){if(!k.body)return setTimeout(a,1);c.isReady=!0;for(var d=0,f=e.length;d<f;d++)e[d](b)}}var b={type:"domready"},d=!1,e=[],f=function(){(k.addEventListener?(k.removeEventListener("DOMContentLoaded",f,!1),a()):"complete"===k.readyState&&(k.detachEvent("onreadystatechange",f),a()))};(function(){if(!d)if(d=
!0,"complete"===document.readyState)setTimeout(a,1);else if(k.addEventListener)k.addEventListener("DOMContentLoaded",f,!1),g.addEventListener("load",a,!1);else{k.attachEvent("onreadystatechange",f);g.attachEvent("onload",a);var b=!1;try{b=null==g.frameElement&&document.documentElement}catch(e){}b&&b.doScroll&&function H(){if(!c.isReady){try{b.doScroll("left")}catch(d){return setTimeout(H,50)}a()}}()}})();return function(a){(c.isReady?a(b):e.push(a))}}();(function(){function a(a){return (10>a?"0"+a:a)}
function b(a){e.lastIndex=0;return (e.test(a)?'"'+a.replace(e,function(a){var b=h[a];return("string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4))})+'"':'"'+a+'"')}function d(a,c){var e,n,h,k,q=f,s,m=c[a];m&&"object"===typeof m&&"function"===typeof m.toJSON&&(m=m.toJSON(a));"function"===typeof l&&(m=l.call(c,a,m));switch(typeof m){case "string":return b(m);case "number":return (isFinite(m)?String(m):"null");case "boolean":case "null":return String(m);case "object":if(!m)return"null";
f+=g;s=[];if("[object Array]"===Object.prototype.toString.apply(m)){k=m.length;for(e=0;e<k;e+=1)s[e]=d(e,m)||"null";h=(0===s.length?"[]":(f?"[\n"+f+s.join(",\n"+f)+"\n"+q+"]":"["+s.join(",")+"]"));f=q;return h}if(l&&"object"===typeof l)for(k=l.length,e=0;e<k;e+=1)"string"===typeof l[e]&&(n=l[e],(h=d(n,m))&&s.push(b(n)+((f?": ":":"))+h));else for(n in m)Object.prototype.hasOwnProperty.call(m,n)&&(h=d(n,m))&&s.push(b(n)+((f?": ":":"))+h);h=(0===s.length?"{}":(f?"{\n"+f+s.join(",\n"+f)+"\n"+q+"}":"{"+s.join(",")+
"}"));f=q;return h}}if("object"===typeof JSON&&"function"===typeof JSON.stringify)return c.JSON={stringify:JSON.stringify},!0;"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return (isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null)},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});
var e=(/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g),f,g,h={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;c.JSON={};c.JSON.stringify=function(a,b,c){var e;g=f="";if("number"===typeof c)for(e=0;e<c;e+=1)g+=" ";else"string"===typeof c&&(g=c);if((l=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})}})();(function(){if(!(document.visibilityState||
document.webkitVisibilityState||document.mozVisibilityState)){document.hidden=!1;document.visibilityState="visible";var a=null,b=function(){(document.createEvent?(a||(a=document.createEvent("HTMLEvents"),a.initEvent("visibilitychange",!0,!0)),document.dispatchEvent(a)):"object"==typeof Visibility&&Visibility._onChange.call(Visibility,{}))},d=function(){document.hidden=!1;document.visibilityState="visible";b()},c=function(){document.hidden=!0;document.visibilityState="hidden";b()};(document.addEventListener?
(g.addEventListener("focus",d,!0),g.addEventListener("blur",c,!0)):(document.attachEvent("onfocusin",d),document.attachEvent("onfocusout",c)))}})();(function(a){var b=g.Visibility={onVisible:function(a){if(!b.isSupported()||!b.hidden())return a(),b.isSupported();var c=b.change(function(f,g){b.hidden()||(b.unbind(c),a())});return c},change:function(a){if(!b.isSupported())return!1;b._lastCallback+=1;var c=b._lastCallback;b._callbacks[c]=a;b._setListener();return c},unbind:function(a){delete b._callbacks[a]},
afterPrerendering:function(a){if(!b.isSupported()||"prerender"!=b.state())return a(),b.isSupported();var c=b.change(function(f,g){"prerender"!=g&&(b.unbind(c),a())});return c},hidden:function(){return b._prop("hidden",!1)},state:function(){return b._prop("visibilityState","visible")},isSupported:function(){return b._prefix()!=a},_doc:g.document,_prefixes:["webkit","moz"],_chechedPrefix:null,_listening:!1,_lastCallback:-1,_callbacks:{},_hiddenBefore:!1,_init:function(){b._hiddenBefore=b.hidden()},
_prefix:function(){if(null!==b._chechedPrefix)return b._chechedPrefix;if(b._doc.visibilityState!=a)return b._chechedPrefix="";for(var c,e=0;e<b._prefixes.length;e++)if(c=b._prefixes[e]+"VisibilityState",b._doc[c]!=a)return b._chechedPrefix=b._prefixes[e]},_name:function(a){var c=b._prefix();return(""==c?a:c+a.substr(0,1).toUpperCase()+a.substr(1))},_prop:function(a,c){return (b.isSupported()?b._doc[b._name(a)]:c)},_onChange:function(a){var c=b.state(),f;for(f in b._callbacks)b._callbacks[f].call(b._doc,
a,c);b._hiddenBefore=b.hidden()},_setListener:function(){if(!b._listening){var a=b._prefix()+"visibilitychange",c=function(){b._onChange.apply(Visibility,arguments)};(b._doc.addEventListener?b._doc.addEventListener(a,c,!1):b._doc.attachEvent(a,c));b._listening=!0;b._hiddenBefore=b.hidden()}}};b._init()})();var x={_env:(/((test[a-z]?|dev|uat|ui|local)\.sh\.(ctrip|huixuan)travel)|(qa\.nt\.ctripcorp)/i),_bfa:(/^\d.+(\.\d+){2,}$/),_bfs:(/^\d+\.\d+$/),_var:(/\$\{(\w+)\}/g)},I=function(a){try{var b=c.CFG.surl+"t/framework/ubt_err.gif?msg=";
(new Image).src=b+c.encode(a)}catch(d){}},t=function(){this.isEventInit=this.isPSSend=this.isPVSend=!1;this.enterTime=c.now();this.commonData=[];this.eSkip=this.pid=0;this.envInit_();this.init()};t.prototype={constructor:t,_QUEUE:[],init:function(){this.isPVSend=!1;this.bfi=this.bfs=this.bfa=null;this.isLogin=this._isNewVisitor=0;this.readBfa();this.sessRead();this.readBfi()},envInit_:function(){("test"==c.ENV||x._env.test(u.hostname)?c.CFG.surl=c.PROTOCOL+"//ubt.test.sh.ctriptravel.com/":"offline"==
c.ENV&&(c.CFG.surl=c.PROTOCOL+"//ubt.sh.ctriptravel.com/"))},inputInit:function(){try{var a={},b=this;document.body.innerHTML.replace((/\bbf_ubt_([^ '"]*)/ig),function(d,f){var g=c.$v(d);if(g){var h=f.split("_");(h[0]&&"tl"==h[0]?(("offline"==c.ENV?"callid"==h[1]&&b.sendData({k:"pvctm",v:'{"callid":"'+g+'"}'}):b._setPVCustom(h[1],g)),a[h[1]]=g):(a[h[0]]=g,b.set_(h[0].toLowerCase(),g)))}});"offline"==c.ENV&&a.eid&&b.sendData({k:"offline_order",v:'{"uid":"'+(a.uid||"")+'","orderid":"'+(a.orderid||"")+'","callid":"'+
a.callid+'","eid":"'+a.eid+'","pid":${page_id},"order_type":"'+(a.order_type||"")+'"}'})}catch(d){}},uniqueId_:function(){return c.getRand()^c.CLI.getHash()&2147483647},plus_:function(a){return parseInt(a,10)+1},setItem:function(a,b,d){if(c.isSupportCookie)c.setCookie(a,b,d);else return!1},getItem:function(a,b,d){return (c.isSupportCookie?c.getCookie(a,b,!0):"")},readBfa:function(){var a=this.getItem("_bfa","",!0);a&&x._bfa.test(a)&&(a=a.split("."),6<a.length&&(this.bfa=a));this.bfa||(a=this.enterTime,
this.bfa=[1,a,this.uniqueId_().toString(36),1,a,a,0,0],this._isNewVisitor=1)},sessRead:function(){var a=this.getItem("_bfs","",!0);(!this._isNewVisitor&&a&&x._bfs.test(a)?(this.bfs=a.split("."),this.bfs[1]=this.plus_(this.bfs[1])):(this.bfs=[1,1],this.bfa[4]=this.bfa[5],this.bfa[5]=this.enterTime,this.bfa[6]=this.plus_(this.bfa[6])));this.bfa[7]=this.plus_(this.bfa[7]);this.sessWrite()},sessWrite:function(){this.setItem("_bfa",this.bfa.join("."),63072E6);this.setItem("_bfs",this.bfs.join("."),18E5)},
readBfi:function(){var a,b,c={};if(a=this.getItem("_bfi","",!0)){a=a.split("&")||[];for(var e=0;e<a.length;e++)b=a[e].split("="),1<b.length&&(c[b[0]]=b[1])}this.ppi=(c&&c.p1?c.p1:0);this.ppv=(c&&c.v1?c.v1:0);this.bfi=c},updateBfi:function(){if(this.isPVSend){var a=this.get_("pvid");this.setItem("_bfi","p1="+this.pid+"&p2="+this.ppi+"&v1="+a+"&v2="+this.ppv)}},get_:function(a){if(this.bfa){var b=this.bfa;switch(a){case "vid":return b[1]+"."+b[2];case "sid":return parseInt(b[6],10)||0;case "pvid":return parseInt(b[7],
10)||0;case "fullpv":return b[1]+"."+b[2]+"."+b[6]+"."+b[7];default:return""}}},set_:function(a,b){switch(a){case "domain":this._setDomain(b);break;case "clickv1":this._setClickV1(b);break;case "collect":this._delCollect(b);break;case "referrer":this._setReferrer(b);break;case "orderid":this._setOrderID(b)}},getPid:function(a){if(!this.pid||a)this.pid=parseInt(c.$v("page_id"),10)||0;return this.pid},getABtest:function(){if(this.d_abtest)return this.d_abtest;for(var a=c.$("ab_testing_tracker"),b=[],
d="";a;)d+=a.value,b.push(a),a.removeAttribute("id"),a.removeAttribute("name"),a=c.$("ab_testing_tracker");for(a=0;a<b.length;a++)b[a].setAttribute("id","ab_testing_tracker");b="";(b=document.location.hash)&&-1!==b.indexOf("abtest=")&&(d+=decodeURIComponent(b.replace((/.*(abtest=)/i),"").replace((/#.*/i),"")));return this.d_abtest=d.substring(0,280)},getPVparams:function(){if(this.d_pvparams)return this.d_pvparams;var a=c.getCookieObj("Session"),b=c.getCookieObj("CtripUserInfo"),d=c.getCookieObj("StartCity_Pkg"),
e=c.getCookieObj("Union"),a={engine:(a&&a.SmartLinkCode?a.SmartLinkCode:""),keyword:(a&&a.SmartLinkQuary?a.SmartLinkQuary:""),start_city:(d&&d.PkgStartCity?d.PkgStartCity:""),alliance_id:(e&&e.AllianceID?e.AllianceID:""),alliance_sid:(e&&e.SID?e.SID:""),alliance_ouid:(e&&e.OUID?e.OUID:""),user_grade:(b&&b.VipGrade?b.VipGrade:""),duid:(b&&b.U?b.U:""),zdata:c.get("zdatactrip",{w:"cookie",v:""}),callid:c.get("bf_ubt_tl_callid",{w:"input",v:""})};a.duid&&(this.isLogin=1);return this.d_pvparams=a},getCommon:function(a){if(a||
4>this.commonData.length)this.commonData=[this.getPid(),this.get_("vid"),this.get_("sid"),this.get_("pvid"),c.get("CorrelationId",{w:"input",v:""}),this.getABtest()||"",c.get("bf_ubt_offline_mid",{w:"input",v:""})];return this.commonData},getUinfo:function(){var a=this.getPVparams(),b=[],d="";try{d+="cl="+document.cookie.length,d+=",ckl="+(document.cookie.match((/[^=]+=[^;]*;?/g))||[]).length}catch(e){}b[0]=7;b[1]=parseInt(this.ppi,10)||0;b[2]=parseInt(this.ppv,10)||0;b[3]=String(c.CFG.href).substring(0,
600);b[4]=c.CLI.s.width;b[5]=c.CLI.s.height;b[6]=d;b[7]=c.CLI.l;b[8]=a.engine;b[9]=a.keyword;b[10]=c.CLI.getRefer();b[11]=this.getABtest();b[12]=this._isNewVisitor;b[13]=this.isLogin;b[14]=c.get("login_uid",{w:"cookie",v:""});b[15]=a.user_grade;b[16]=c.get("corpid",{w:"cookie",v:""});b[17]=a.start_city;b[18]=a.alliance_id;b[19]=a.alliance_sid;b[20]=a.alliance_ouid;b[21]=c.CFG.orderID;b[22]=a.duid;b[23]=a.zdata;b[24]=a.callid;b[25]=c.get("bid",{w:"cookie",v:""});return b},replaceParam:function(a){var b=
{duid:this.getPVparams().duid,page_id:this.getPid(),is_login:this.isLogin};return a.replace(x._var,function(a,c){return (c in b?b[c]:a)})},dataHandler:function(a){if("string"==typeof a)return a;if("object"==typeof a){if(a.c&&a.d)return a={c:this.getCommon(),d:a.d},"ac=g&d="+c.encode(c.JSON.stringify(a));if(a.k&&a.v){var b=c.encode(this.replaceParam(a.v));return"ac=tl&pi="+this.getPid()+"&key="+a.k+"&val="+b+"&pv="+this.get_("fullpv")+"&v=6"}}return!1},sendData:function(a){if(this.isPVSend){var b=this.dataHandler(a);
b&&c.send(b,a.callback||w)}else this._QUEUE.push(a)},sendPV:function(a){var b=this;if(this.isPVSend)return!0;try{var d={c:this.getCommon(!0),d:{uinfo:this.getUinfo()}},e="ac=g&d="+c.encode(c.JSON.stringify(d));c.send(e,function(d){d&&(b.isPVSend=!0,b.queueSend_());c.isFunction(a)&&a(d)})}catch(f){I(f.message||f.description||"&line:"+name.lineNumber||name.line||0)}},queueSend_:function(){this.updateBfi();var a=this._QUEUE,b=a.length;if(b){for(var d=0;d<b;d++){var e=a[d],f=this.dataHandler(e);f&&c.send(f,
e.callback||w)}this._QUEUE=[]}c.PVCTM&&this.sendData({k:"pvctm",v:c.JSON.stringify(c.PVCTM)});return!0},getPS:function(){for(var a="navigationStart redirectStart unloadEventStart unloadEventEnd redirectEnd fetchStart domainLookupStart domainLookupEnd connectStart connectEnd requestStart responseStart responseEnd domLoading domInteractive domContentLoadedEventStart domContentLoadedEventEnd domComplete loadEventStart loadEventEnd".split(" "),b=g.performance.timing,c=[6],e=0;e<a.length;e++)c.push(b[a[e]]);
c.push(g.performance.navigation.type||0);c.push(g.performance.navigation.redirectCount||0);return c},sendPS:function(){if(!(c.CFG.dCollect.performance||!g.performance||0>this.getPid())){var a=0,b=this;(function(){if(g.performance.timing.loadEventEnd&&!this.isPSSend){var d={c:b.getCommon(),d:{ps:b.getPS()}},d="ac=g&d="+c.encode(c.JSON.stringify(d));c.send(d);b.isPSSend=!0}else 300>a&&(a++,setTimeout(arguments.callee,300))})()}},bindSend:function(a){var b=this;if(this.isEventInit)return!0;this.isEventInit=
!0;this.inputInit();this.sendPV(a);Visibility.change(function(a,c){"visible"==c&&b.updateBfi()});this.sendPS();if(!c.CFG.dCollect.click)c.on(k,"mousedown",function(a){var b;b=a||g.event;var f="";if((a=b.target||b.srcElement)&&a.parentNode&&a!=k){a.getAttribute("_bfClick")&&(f=a.getAttribute("_bfClick"),f=("CLICKTIME"==f?"CT"+10*Math.round((+new Date-v.enterTime)/1E4):f));var p=parseInt(Math.max(k.documentElement.clientWidth||k.body.clientWidth,k.documentElement.scrollWidth||k.body.scrollWidth)/2,10),
p=("pageX"in b?b.pageX-p:b.clientX+(k.body.scrollLeft||k.documentElement.scrollLeft)-p);b=("pageY"in b?b.pageY:b.clientY+(k.body.scrollTop||k.documentElement.scrollTop));a=["ac=record","pv="+h.get_("fullpv"),"pi="+h.getPid(),"ct="+c.now(),"x="+p,"y="+b,"xp="+c.encode(((h.getABtest()?h.getABtest().toUpperCase()+"/":""))+c.getXpath(a).replace("HTML/","")),"ppi="+1*h.ppi,"va1="+c.encode(h.getABtest()),"va2="+c.encode(f),"va3="+c.encode(c.CFG.cv1||""),"v=6"].join("&");h.sendData(a)}},!0)},_asynRefresh:function(a,
b){"object"==typeof a&&(a.page_id&&(this.pid=parseInt(a.page_id,10)||0),a.url&&c.contains(a.url,"http")&&(c.CFG.href=a.url),a.orderid&&(c.CFG.orderID=a.orderid),a.refer&&this._setReferrer(a.refer));(this.isEventInit?(this.init(),this.sendPV(b)):this.bindSend(b))},_setEnv:function(a){c.ENV=a||"online";this.envInit_()},_setDebug:function(a){c.CFG.debug=!!a},_setDomain:function(a){c.CFG.domain=a},_setClickV1:function(a){c.CFG.cv1=a||""},_delCollect:function(a){},_setReferrer:function(a){c.CFG.referrer=
a},_setOrderID:function(a){a&&(c.CFG.orderID=a)},_setPVCustom:function(a,b){c.PVCTM||(c.PVCTM={});c.PVCTM[a]=b},_tracklog:function(a,b,c){if("string"!=typeof b)return!1;this.sendData({k:a,v:b,callback:c||!1})},_trackError:function(a,b){if("object"!=c.type(a))return!1;if(this.eSkip&&"undefined"==typeof a.skip)return this.eSkip=!1;!0===a.skip&&(this.eSkip=!0);for(var d="version message line file category framework time repeat islogin name column".split(" "),e=[7,"",0,"","","",c.now()-this.enterTime,
1,this.isLogin,"",0],f=1,g=d.length;f<g;f++){var h=d[f];if(a[h]){var k=a[h]+"";switch(h){case "message":case "file":k=k.substring(0,500);break;case "category":case "framework":case "name":k=k.substring(0,100);break;case "time":k=parseInt(k,10);break;case "column":k=parseInt(k,10);break;default:k=parseInt(k,10)||0}e[f]=k}}d="";(a.stack?d=a.stack:"undefined"!=typeof cQuery&&c.isFunction(cQuery.trace)&&(d=cQuery.trace(),c.isArray(d)&&(d=d.join(""))));d=d.slice(e.join("").length-2E3);e.push(d);this.sendData({c:!0,
d:{error:e},callback:b||!1})},_trackUserBlock:function(a,b){if("object"!=typeof a)return!1;var c=[6];c[1]=this.isLogin;c[2]=String(a.message||"").substring(0,300);c[3]=String(a.value||"").substring(0,300);c[4]=String(a.type||"").substring(0,50);c[5]=String(a.dom||"").substring(0,100);c[6]=String(a.form||"").substring(0,100);c[7]=parseInt(a.count||0,10)||0;this.sendData({c:!0,d:{ub:c},callback:b||!1})}};var h=new t,y=new function(){this.push=function(a){for(var b=arguments,c=0,e=b.length,g=0;g<e;g++)try{if("function"===
typeof b[g])b[g]();else{var k=b[g][0];"_"==k.substring(0,1)&&h[k].apply(h,b[g].slice(1))}}catch(q){c++}return c}},J=alert,C=0;(function(){try{g.alert=function(a){C++;y.push(["_trackUserBlock",{message:a,value:"alert",type:"function.alert",dom:"",form:"",count:C}]);J(a)}}catch(a){}})();a:{var z=g.__bfi,t=!1;if(z&&"function"==typeof z.push&&(t=c.isArray(z),!t))break a;g.__bfi=y;t&&y.push.apply(y,z)}g.$_bf._getFullPV=function(){return h.get_("fullpv")};g.$_bf.tracklog=function(a,b,c){h._tracklog(a,b,
c)};g.$_bf.trackError=function(a,b){h._trackError(a,b)};g.$_bf._getStatue=function(){return{vid:h.get_("vid"),sid:h.get_("sid"),pvid:h.get_("pvid"),pid:h.getPid(),abtest:h.getABtest(),pv:h.isPVSend,ps:h.isPSSend}};g.$_bf.asynRefresh=function(a,b){h._asynRefresh(a,b)};var D=function(){("wait"==c.$v("page_id")?setTimeout(D,300):h.bindSend())};(function(){(0!=h.getPid()?h.bindSend():setTimeout(arguments.callee,100))})();c.ready(D);c.on(g,"beforeunload",function(){h.bindSend()});if("null"==c.type(g.onerror)){var E=
{};g.onerror=function(){if("undefined"==typeof cQuery||!cQuery.config||!cQuery.config("allowDebug"))try{var a=arguments,b={message:""+a[0],file:""+a[1],line:a[2],category:"inner-error",framework:"normal",time:c.now()-h.enterTime,repeat:1},d=b.message+b.file+b.line;E[d]||(h._trackError(b),E[d]=!0)}catch(e){}}}(function(a){function b(a,b){var c=null;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){a.apply(d,e)},b)}}function d(){this._queue=[];this._init()}if("offline"!=
c.ENV&&!c.ishttps&&"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&a.performance){var e=h.get_("vid");if(!e||5<c.hash(e)%1E3)return!1;var f={};(function(a){function b(a){var c=0,d=[],e=0;this.n=function(){if(0==e){if(c>=a.length)return null;var b=a.charCodeAt(c++);if(127>=b)return b;if(2047>=b)return d[1]=128|b&63,e=1,192|b>>6&31;if(55296<=b&&57343>=b)throw"unsupported char code.";d[0]=128|b>>6&63;d[1]=128|b&63;e=2;return 224|b>>12&15}return d[d.length-e--]}}function c(a){var b=new function(a){for(var b=
[],c=-1,d;null!=(d=a.n());)if(0==d[0]){if(-1==c||255==b[c])b.push(128),c=b.length-1;b.push(d[1]);b[c]++}else{c=-1;b.push(d[0]);var e=d[1];if(127>=e)b.push(e);else{for(d=[];0<e;)d.push(e&127),e>>=7;for(e=d.length-1;0<=e;e--)b.push(d[e]|128);b[b.length-1]&=127}}c=0;this.n=function(){return (c>=b.length?null:b[c++])}}(new function(a){function b(a,c){for(var d=0,e=0;e<k;e++)d=131*d+a[c+e];return d}for(var c=[],d=[],f=[],h,r=0,A,n;null!=(h=a.n());)f.push(h);this.n=function(){if(r<f.length-k+1){for(var a=
b(f,r),h=n=A=0;h<d.length;h++)if(a==d[h]){var m,l;m=h;for(l=r;m<c.length&&l<f.length&&!(c[m]!=f[l]||l-r>=g);m++,l++);m-h>=n&&m-h>=k&&(n=m-h,A=h)}if(0==n)return a=[0,f[r]],h=f[r++],c.push(h),c.length>e&&(c.shift(),d.shift()),c.length>=k&&(h=c.length-k,d[h]=b(c,h)),a;r+=n;return[n,c.length-(A+n)]}return (r<f.length?[0,f[r++]]:null)}}(a));this.n=function(){return b.n()}}function d(a){var b=[],c=0;this.n=function(){if(0<c)return b[4-c--];var d=[a.n(),a.n(),a.n()];if(null==d[0])return null;b[0]=f.charAt(d[0]>>
2);b[1]=(null==d[1]?f.charAt(d[0]<<4&63):f.charAt((d[0]<<4|d[1]>>4)&63));b[2]=(null==d[1]?"~":(null==d[2]?f.charAt(d[1]<<2&63):f.charAt((d[1]<<2|d[2]>>6)&63)));b[3]=(null==d[2]?"~":f.charAt(d[2]&63));c=3;return b[0]}}var e=1024,g=63,k=3,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";a.compress=function(a){a=new b(a);a=new c(a);a=new d(a);for(var e,f=[];null!=(e=a.n());)f[f.length]=e;return f.join("")}})(f);var k=a.document,q=k.documentElement,e="1.0.0".trim,l=(k.addEventListener?function(a,
b,c,d){a.addEventListener&&a.addEventListener(b,c,d)}:function(a,b,c){a.attachEvent&&a.attachEvent("on"+b,c)});e&&e.call("\ufeff\u00a0");d.prototype={constructor:d,_init:function(){var c=this;l(a,"scroll",b(function(a){c.collectScroll(a)},300));l(a,"resize",b(function(a){c.collectViewport(a)},500));l(k,"click",function(a){c.collectClick(a);c.collectChange(a)},!0);this.collectViewport()},_sendData:function(a){var b=(c.CFG.debug?"http://localhost/bf.gif?ac=a&d=":c.CFG.surl+"bf.gif?ac=a&d="),b=b+(f.compress(a)+
"&jv=1.0.0"),d=(new Image);d.onload=function(){d=d.onload=null};d.src=b},_getTagIndex:function(a){var b=0;if(a.parentNode)for(var c=a.parentNode.firstChild;c&&c!=a;)1==c.nodeType&&c.tagName==a.tagName&&b++,c=c.nextSibling;return (0<b?"["+ ++b+"]":"")},_getXpath:function(a){for(var b=[],c=0,d;a&&9!=a.nodeType;){var e=a.nodeName+this._getTagIndex(a)+((a.id?"[@id='"+a.id+"']":""));if(d=a.getAttribute("block"))e+="[@block='"+d+"']";b[c++]=e;a=a.parentNode}return b.reverse().join("/")},_push:function(a,b,c){this._queue.push({action:a,
xpath:b,ts:c||+new Date});this._checkSend()},_checkSend:function(a){if(a||5<this._queue.length)a=[[1],[h.pid,h.get_("vid"),h.get_("sid"),h.get_("pvid")],this._queue],this._sendData(JSON.stringify(a)),this._queue=[]},_getFocus:function(){var a=k.activeElement;return (a&&(a.type||a.href||~a.tabIndex)?a:null)},collectChange:function(a){this._getFocus()},collectViewport:function(a){this._push("viewport","HTML/BODY"+("[@w='"+(q.clientWidth||k.body.clientWidth)+"'][h='"+(q.clientHeight||k.body.clientHeight)+
"']"))},collectScroll:function(a){a=Math.max(q.scrollLeft,k.body.scrollLeft);var b=Math.max(q.scrollTop,k.body.scrollTop);this._push("scroll","HTML/BODY"+("[@x='"+a+"'][@y='"+b+"']"))},collectClick:function(a){var b=a.target||a.srcElement,c=b.nodeName.toUpperCase();if(b.getBoundingClientRect){var d=b.getBoundingClientRect(),e="",f=Math.max(q.scrollLeft,k.body.scrollLeft),g=Math.max(q.scrollTop,k.body.scrollTop),h=a.pageX||a.clientX+f;a=a.pageY||a.clientY+g;var l=parseInt((q.clientWidth||k.body.clientWidth)/
2,10);("SELECT"==c&&0>a-d.top-g?(e+="[@x='"+parseInt(h+d.left+f-l,10)+"'][@y='"+parseInt(a+d.top,10)+"']",e=e+("[@rx='"+h+"']")+("[@ry='"+(a-g)+"']")):(e+="[@x='"+(h-l)+"'][@y='"+a+"']",e+="[@rx='"+parseInt(h-d.left-f,10)+"']",e+="[@ry='"+parseInt(a-d.top-g,10)+"']"));this._push("click",this._getXpath(b)+e)}}};var t=new d;c.on(g,"beforeunload",function(){t._checkSend(!0)})}})(g)}}catch(K){}})(window);
